{
  "name": "aws-cloudwatch-log",
  "version": "1.0.0",
  "label": "AWS CloudWatch Log",
  "description": "AWS CloudWatch Log enables you to monitor, store, and access your system, application, and custom log files. This connector facilitates the automate operations related to the log group, log streams and metrics.",
  "publisher": "Fortinet",
  "cs_approved": true,
  "cs_compatible": true,
  "category": "AWS Services",
  "icon_small_name": "cyops_small.png",
  "icon_large_name": "cyops_large.png",
  "help_online": "",
  "configuration": {
    "fields": [
      {
        "title": "Configuration Type",
        "required": true,
        "editable": true,
        "visible": true,
        "type": "select",
        "name": "config_type",
        "tooltip": "AWS configuration type",
        "description": "Type of configuration using which you will provide credentials to access AWS CloudWatch and perform automated actions. You can select between IAM RoleorAccess Credentials. If you selectIAM Role, then enter details in the following field(s): AWS Instance IAM Role: IAM Role of your AWS instance to access AWS services. If you selectAccess Credentials, then enter details in the following field(s): AWS Region: AWS region of your account to access the AWS CloudWatch. AWS Access Key ID: ID of the AWS Access Key to access AWS services. AWS Secret Access Key: Key of the AWS Secret Access to access AWS services.",
        "options": [
          "Access Credentials",
          "AWS Instance IAM Role"
        ],
        "onchange": {
          "AWS Instance IAM Role": [
            {
              "title": "AWS Instance IAM Role Name",
              "required": true,
              "editable": true,
              "visible": true,
              "type": "text",
              "name": "aws_iam_role",
              "tooltip": "IAM Role Name of your AWS Instance where FortiSOAR installed, to access AWS services.",
              "description": "IAM Role Name of your AWS Instance where FortiSOAR installed, to access AWS services."
            }
          ],
          "Access Credentials": [
            {
              "title": "AWS Region",
              "required": true,
              "editable": true,
              "visible": true,
              "type": "text",
              "name": "aws_region",
              "placeholder": "e.g. us-east-2",
              "tooltip": "AWS region of your account to access the AWS CloudWatch",
              "description": "AWS region of your account to access the AWS CloudWatch"
            },
            {
              "title": "AWS Access Key ID",
              "required": true,
              "editable": true,
              "visible": true,
              "type": "text",
              "name": "aws_access_key",
              "tooltip": "ID of the AWS Access Key to access AWS services",
              "description": "ID of the AWS Access Key to access AWS services"
            },
            {
              "title": "AWS Secret Access Key",
              "required": true,
              "editable": true,
              "visible": true,
              "type": "password",
              "name": "aws_secret_access_key",
              "tooltip": "Key of the AWS Secret Access to access AWS services",
              "description": "Key of the AWS Secret Access to access AWS services"
            }
          ]
        }
      },
      {
        "title": "Verify SSL",
        "description": "Specifies whether the SSL certificate for the server is to be verified or not. By default, this option is set as True.",
        "required": false,
        "editable": true,
        "visible": true,
        "type": "checkbox",
        "name": "verify_ssl",
        "value": true
      }
    ]
  },
  "operations": [
    {
      "title": "Create Log Group",
      "operation": "create_log_group",
      "description": "Creates a log group with the specified name.",
      "category": "utilities",
      "enabled": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Enable to assume a role",
          "description": "Select this option to assume a role. This parameter is required, if you have specified 'IAM Role' as the 'Configuration Type'. If you have specified 'Access Credentials' as the 'Configuration Type', then this parameter is optional. If you choose'True', then you must specify the following parameters: AWS Region: AWS region of your account to access the AWS Access Analyzer Role ARN: ARN of the role that you want assume to execute this action on AWS. Session Name: Name of the session that will be created to execute this action on AWS.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "Your account's AWS region",
                "description": "AWS region of your account to access the AWS Access Analyzer"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Log Group Name",
          "description": "The name of the log group.",
          "type": "text",
          "name": "logGroupName",
          "required": true,
          "visible": true,
          "editable": true
        },
        {
          "title": "KMS Key ID",
          "description": "The Amazon Resource Name (ARN) of the CMK to use when encrypting log data.",
          "tooltip": "The Amazon Resource Name (ARN) of the CMK to use when encrypting log data.",
          "type": "text",
          "name": "kmsKeyId",
          "required": false,
          "visible": true,
          "editable": true
        },
        {
          "title": "Tags",
          "description": "Provide the key-value pairs to add the tags.",
          "tooltip": "Provide tags in key-value pairs e.g {\"CWLogs\":\"Linux\"}",
          "type": "json",
          "name": "tags",
          "required": false,
          "visible": true,
          "editable": true,
          "placeholder": "{\"tagName\":\"tagValue\"}"
        }
      ],
      "output_schema": {
        "ResponseMetadata": {
          "RequestId": "",
          "HTTPStatusCode": "",
          "HTTPHeaders": {
            "x-amzn-requestid": "",
            "content-type": "",
            "content-length": "",
            "date": ""
          },
          "RetryAttempts": ""
        }
      }
    },
    {
      "title": "Create Log Stream",
      "operation": "create_log_stream",
      "description": "Creates a log stream for the specified log group in Amazon CloudWatch",
      "category": "utilities",
      "enabled": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Enable to assume a role",
          "description": "Select this option to assume a role. This parameter is required, if you have specified 'IAM Role' as the 'Configuration Type'. If you have specified 'Access Credentials' as the 'Configuration Type', then this parameter is optional. If you choose'True', then you must specify the following parameters: AWS Region: AWS region of your account to access the AWS Access Analyzer Role ARN: ARN of the role that you want assume to execute this action on AWS. Session Name: Name of the session that will be created to execute this action on AWS.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "Your account's AWS region",
                "description": "AWS region of your account to access the AWS Access Analyzer"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Log Group Name",
          "description": "The name of the log group.",
          "type": "text",
          "name": "logGroupName",
          "required": true,
          "visible": true,
          "editable": true
        },
        {
          "title": "Log Stream Name",
          "description": "The name of the log stream.",
          "type": "text",
          "name": "logStreamName",
          "required": true,
          "visible": true,
          "editable": true
        }
      ],
      "output_schema": {
        "ResponseMetadata": {
          "RequestId": "",
          "HTTPStatusCode": "",
          "HTTPHeaders": {
            "x-amzn-requestid": "",
            "content-type": "",
            "content-length": "",
            "date": ""
          },
          "RetryAttempts": ""
        }
      }
    },
    {
      "title": "Get Log Groups List",
      "operation": "get_list_log_groups",
      "description": "Lists the specified log groups. You can list all your log groups or filter the results by prefix of log group name.",
      "category": "utilities",
      "enabled": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Enable to assume a role",
          "description": "Select this option to assume a role. This parameter is required, if you have specified 'IAM Role' as the 'Configuration Type'. If you have specified 'Access Credentials' as the 'Configuration Type', then this parameter is optional. If you choose'True', then you must specify the following parameters: AWS Region: AWS region of your account to access the AWS Access Analyzer Role ARN: ARN of the role that you want assume to execute this action on AWS. Session Name: Name of the session that will be created to execute this action on AWS.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "Your account's AWS region",
                "description": "AWS region of your account to access the AWS Access Analyzer"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Log Group Name Prefix",
          "description": "The log group name prefix to match.",
          "tooltip": "Prefix to match. e.g. For log group 'MySysLog', provide 'MySys'. If left blank, lists all the log groups",
          "type": "text",
          "name": "logGroupNamePrefix",
          "required": false,
          "visible": true,
          "editable": true
        },
        {
          "title": "Next Page Token",
          "description": "The token for the next set of items to return.",
          "type": "text",
          "name": "nextToken",
          "required": false,
          "visible": true,
          "editable": true
        },
        {
          "title": "Limit",
          "description": "The maximum number of items returned. If left blank, the default is up to 50 items.",
          "type": "integer",
          "name": "limit",
          "required": false,
          "visible": true,
          "editable": true
        }
      ],
      "output_schema": {
        "logGroups": [
          {
            "logGroupName": "",
            "creationTime": "",
            "metricFilterCount": "",
            "arn": "",
            "storedBytes": ""
          }
        ],
        "ResponseMetadata": {
          "RequestId": "",
          "HTTPStatusCode": "",
          "HTTPHeaders": {
            "x-amzn-requestid": "",
            "content-type": "",
            "content-length": "",
            "date": ""
          },
          "RetryAttempts": ""
        }
      }
    },
    {
      "title": "Get Log Streams List",
      "operation": "get_list_log_streams",
      "description": "Get lists the log streams for the specified log group. You can list all the log streams or filter the results by prefix.",
      "category": "utilities",
      "enabled": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Enable to assume a role",
          "description": "Select this option to assume a role. This parameter is required, if you have specified 'IAM Role' as the 'Configuration Type'. If you have specified 'Access Credentials' as the 'Configuration Type', then this parameter is optional. If you choose'True', then you must specify the following parameters: AWS Region: AWS region of your account to access the AWS Access Analyzer Role ARN: ARN of the role that you want assume to execute this action on AWS. Session Name: Name of the session that will be created to execute this action on AWS.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "Your account's AWS region",
                "description": "AWS region of your account to access the AWS Access Analyzer"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Log Group Name",
          "description": "The name of the log group.",
          "tooltip": "The name of the log group.",
          "type": "text",
          "name": "logGroupName",
          "required": true,
          "visible": true,
          "editable": true
        },
        {
          "title": "Order By",
          "name": "orderBy",
          "description": "The results to be ordered by the Log Stream Name or Event Time",
          "visible": true,
          "required": false,
          "editable": true,
          "type": "select",
          "options": [
            "LogStreamName",
            "LastEventTime"
          ],
          "onchange": {
            "LogStreamName": [
              {
                "title": "Log Stream Name Prefix ",
                "description": "The log stream name prefix to match.",
                "tooltip": "Prefix to match. e.g. For log stream 'MySysLogStream', provide 'MySys'. If left blank, lists all the log groups",
                "type": "text",
                "name": "logStreamNamePrefix",
                "required": false,
                "visible": true,
                "editable": true
              }
            ]
          }
        },
        {
          "title": "Next Page Token",
          "description": "The token for the next set of items to return.",
          "type": "text",
          "name": "nextToken",
          "required": false,
          "visible": true,
          "editable": true
        },
        {
          "title": "Limit",
          "description": "The maximum number of items returned. If left blank, the default is up to 50 items.",
          "type": "integer",
          "name": "limit",
          "required": false,
          "visible": true,
          "editable": true
        }
      ],
      "output_schema": {
        "logStreams": [
          {
            "logStreamName": "",
            "creationTime": "",
            "arn": "",
            "storedBytes": ""
          }
        ],
        "ResponseMetadata": {
          "RequestId": "",
          "HTTPStatusCode": "",
          "HTTPHeaders": {
            "x-amzn-requestid": "",
            "content-type": "",
            "content-length": "",
            "date": ""
          },
          "RetryAttempts": ""
        }
      }
    },
    {
      "title": "Get Log Events",
      "operation": "get_log_events",
      "description": "Get lists log events from the specified log stream. You can list all of the log events or filter using a time range.",
      "category": "utilities",
      "enabled": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Enable to assume a role",
          "description": "Select this option to assume a role. This parameter is required, if you have specified 'IAM Role' as the 'Configuration Type'. If you have specified 'Access Credentials' as the 'Configuration Type', then this parameter is optional. If you choose'True', then you must specify the following parameters: AWS Region: AWS region of your account to access the AWS Access Analyzer Role ARN: ARN of the role that you want assume to execute this action on AWS. Session Name: Name of the session that will be created to execute this action on AWS.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "Your account's AWS region",
                "description": "AWS region of your account to access the AWS Access Analyzer"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Log Group Name",
          "description": "The name of the log group.",
          "type": "text",
          "name": "logGroupName",
          "required": true,
          "visible": true,
          "editable": true
        },
        {
          "title": "Log Stream Name",
          "description": "The name of the log stream.",
          "type": "text",
          "name": "logStreamName",
          "required": true,
          "visible": true,
          "editable": true
        },
        {
          "title": "Start Time",
          "description": "The start of the time range for which log events to be fetched.",
          "type": "datetime",
          "name": "startTime",
          "required": false,
          "visible": true,
          "editable": true
        },
        {
          "title": "End Time",
          "description": "The end of the time range for which log events to be fetched.",
          "type": "datetime",
          "name": "endTime",
          "required": false,
          "visible": true,
          "editable": true
        },
        {
          "title": "Next Page Token",
          "description": "The token for the next set of items to return.",
          "type": "text",
          "name": "nextToken",
          "required": false,
          "visible": true,
          "editable": true
        },
        {
          "title": "Limit",
          "description": "The maximum number of log events returned.",
          "type": "integer",
          "name": "limit",
          "required": false,
          "visible": true,
          "editable": true,
          "value": 10
        },
        {
          "title": "Oldest Logs First",
          "description": "If the value is true, the earliest log events are returned first. If the value is false, the latest log events are returned first. The default value is false.",
          "tooltip": "If the value is false, the latest log events are returned first. If you are using a previous nextForwardToken value as the nextToken then you must specify true.",
          "type": "checkbox",
          "name": "startFromHead",
          "required": false,
          "visible": true,
          "editable": true,
          "value": true
        }
      ],
      "output_schema": {
        "events": [],
        "nextForwardToken": "",
        "nextBackwardToken": "",
        "ResponseMetadata": {
          "RequestId": "",
          "HTTPStatusCode": "",
          "HTTPHeaders": {
            "x-amzn-requestid": "",
            "content-type": "",
            "content-length": "",
            "date": ""
          },
          "RetryAttempts": ""
        }
      }
    },
    {
      "title": "Delete Log Group",
      "operation": "delete_log_group",
      "description": "Deletes the specified log group and permanently deletes all the archived log events associated with the log group.",
      "category": "utilities",
      "enabled": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Enable to assume a role",
          "description": "Select this option to assume a role. This parameter is required, if you have specified 'IAM Role' as the 'Configuration Type'. If you have specified 'Access Credentials' as the 'Configuration Type', then this parameter is optional. If you choose'True', then you must specify the following parameters: AWS Region: AWS region of your account to access the AWS Access Analyzer Role ARN: ARN of the role that you want assume to execute this action on AWS. Session Name: Name of the session that will be created to execute this action on AWS.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "Your account's AWS region",
                "description": "AWS region of your account to access the AWS Access Analyzer"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Log Group Name",
          "description": "The name of the log group is to be deleted.",
          "type": "text",
          "name": "logGroupName",
          "required": true,
          "visible": true,
          "editable": true
        }
      ],
      "output_schema": {
        "ResponseMetadata": {
          "RequestId": "",
          "HTTPStatusCode": "",
          "HTTPHeaders": {
            "x-amzn-requestid": "",
            "content-type": "",
            "content-length": "",
            "date": ""
          },
          "RetryAttempts": ""
        }
      }
    },
    {
      "title": "Delete Log Stream",
      "operation": "delete_log_stream",
      "description": "Deletes the specified log stream and permanently deletes all the archived log events associated with the log stream.",
      "category": "utilities",
      "enabled": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Enable to assume a role",
          "description": "Select this option to assume a role. This parameter is required, if you have specified 'IAM Role' as the 'Configuration Type'. If you have specified 'Access Credentials' as the 'Configuration Type', then this parameter is optional. If you choose'True', then you must specify the following parameters: AWS Region: AWS region of your account to access the AWS Access Analyzer Role ARN: ARN of the role that you want assume to execute this action on AWS. Session Name: Name of the session that will be created to execute this action on AWS.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "Your account's AWS region",
                "description": "AWS region of your account to access the AWS Access Analyzer"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Log Group Name",
          "description": "The name of the log group.",
          "type": "text",
          "name": "logGroupName",
          "required": true,
          "visible": true,
          "editable": true
        },
        {
          "title": "Log Stream Name",
          "description": "The name of the log stream is to be deleted.",
          "type": "text",
          "name": "logStreamName",
          "required": true,
          "visible": true,
          "editable": true
        }
      ],
      "output_schema": {
        "ResponseMetadata": {
          "RequestId": "",
          "HTTPStatusCode": "",
          "HTTPHeaders": {
            "x-amzn-requestid": "",
            "content-type": "",
            "content-length": "",
            "date": ""
          },
          "RetryAttempts": ""
        }
      }
    },
    {
      "title": "Create Log Retention Policy",
      "operation": "create_log_retention_policy",
      "description": "Sets the retention of the specified log group. A retention policy allows you to configure the number of days for which to retain log events in the specified log group.",
      "category": "utilities",
      "enabled": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Enable to assume a role",
          "description": "Select this option to assume a role. This parameter is required, if you have specified 'IAM Role' as the 'Configuration Type'. If you have specified 'Access Credentials' as the 'Configuration Type', then this parameter is optional. If you choose'True', then you must specify the following parameters: AWS Region: AWS region of your account to access the AWS Access Analyzer Role ARN: ARN of the role that you want assume to execute this action on AWS. Session Name: Name of the session that will be created to execute this action on AWS.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "Your account's AWS region",
                "description": "AWS region of your account to access the AWS Access Analyzer"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Log Group Name",
          "description": "The name of the log group.",
          "type": "text",
          "name": "logGroupName",
          "required": true,
          "visible": true,
          "editable": true
        },
        {
          "title": "Retention Period",
          "description": "Time period to retain the log events in the specified log group.",
          "name": "retentionInDays",
          "type": "select",
          "options": [
            "1 Day",
            "3 Days",
            "5 Days",
            "1 Week",
            "2 Weeks",
            "1 Month",
            "2 Months",
            "3 Months",
            "4 Months",
            "5 Months",
            "6 Months",
            "12 Months",
            "13 Months",
            "18 Months",
            "24 Months",
            "60 Months",
            "120 Months"
          ],
          "required": true,
          "visible": true,
          "editable": true,
          "value": "1 Day"
        }
      ],
      "output_schema": {
        "ResponseMetadata": {
          "RequestId": "",
          "HTTPStatusCode": "",
          "HTTPHeaders": {
            "x-amzn-requestid": "",
            "content-type": "",
            "content-length": "",
            "date": ""
          },
          "RetryAttempts": ""
        }
      }
    },
    {
      "title": "Delete Log Retention Policy",
      "operation": "delete_log_retention_policy",
      "description": "Deletes the retention of the specified log group. Log events do not expire if they belong to log groups without a retention policy.",
      "category": "utilities",
      "enabled": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Enable to assume a role",
          "description": "Select this option to assume a role. This parameter is required, if you have specified 'IAM Role' as the 'Configuration Type'. If you have specified 'Access Credentials' as the 'Configuration Type', then this parameter is optional. If you choose'True', then you must specify the following parameters: AWS Region: AWS region of your account to access the AWS Access Analyzer Role ARN: ARN of the role that you want assume to execute this action on AWS. Session Name: Name of the session that will be created to execute this action on AWS.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "Your account's AWS region",
                "description": "AWS region of your account to access the AWS Access Analyzer"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Log Group Name",
          "description": "The name of the log group.",
          "type": "text",
          "name": "logGroupName",
          "required": true,
          "visible": true,
          "editable": true
        }
      ],
      "output_schema": {
        "ResponseMetadata": {
          "RequestId": "",
          "HTTPStatusCode": "",
          "HTTPHeaders": {
            "x-amzn-requestid": "",
            "content-type": "",
            "content-length": "",
            "date": ""
          },
          "RetryAttempts": ""
        }
      }
    },
    {
      "title": "Upload Log Event",
      "operation": "upload_log_event",
      "description": "Uploads a batch of log events to the specified log stream",
      "category": "utilities",
      "enabled": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Enable to assume a role",
          "description": "Select this option to assume a role. This parameter is required, if you have specified 'IAM Role' as the 'Configuration Type'. If you have specified 'Access Credentials' as the 'Configuration Type', then this parameter is optional. If you choose'True', then you must specify the following parameters: AWS Region: AWS region of your account to access the AWS Access Analyzer Role ARN: ARN of the role that you want assume to execute this action on AWS. Session Name: Name of the session that will be created to execute this action on AWS.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "Your account's AWS region",
                "description": "AWS region of your account to access the AWS Access Analyzer"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Log Group Name",
          "description": "The name of the log group.",
          "type": "text",
          "name": "logGroupName",
          "required": true,
          "visible": true,
          "editable": true
        },
        {
          "title": "Log Stream Name",
          "description": "The name of the log stream.",
          "type": "text",
          "name": "logStreamName",
          "required": true,
          "visible": true,
          "editable": true
        },
        {
          "title": "Timestamp",
          "description": "Timestamp of log event",
          "type": "datetime",
          "name": "timestamp",
          "required": true,
          "visible": true,
          "editable": true,
          "tooltip": "Choose date or provide epoch timestamp in milliseconds\n e.g 1633890600807"
        },
        {
          "title": "Message",
          "description": "Message of log event",
          "type": "text",
          "name": "message",
          "required": true,
          "visible": true,
          "editable": true
        },
        {
          "title": "Sequence Token",
          "description": "The sequence token obtained from the response of the previous upload call",
          "type": "text",
          "name": "sequenceToken",
          "required": false,
          "visible": true,
          "editable": true,
          "tooltip": "The sequence token can be obtained using 'Get Log Streams List' operation or from the previous upload call"
        }
      ],
      "output_schema": {
        "rejectedLogEventsInfo": {
          "tooOldLogEventEndIndex": ""
        },
        "ResponseMetadata": {
          "RequestId": "",
          "HTTPStatusCode": "",
          "HTTPHeaders": {
            "x-amzn-requestid": "",
            "content-type": "",
            "content-length": "",
            "date": ""
          },
          "RetryAttempts": ""
        }
      }
    },
    {
      "title": "Run Log Insight Query",
      "operation": "run_log_insight_query",
      "description": "Schedules a query of a log group using CloudWatch Logs Insights for the specified log group and time range.",
      "category": "utilities",
      "enabled": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Enable to assume a role",
          "description": "Select this option to assume a role. This parameter is required, if you have specified 'IAM Role' as the 'Configuration Type'. If you have specified 'Access Credentials' as the 'Configuration Type', then this parameter is optional. If you choose'True', then you must specify the following parameters: AWS Region: AWS region of your account to access the AWS Access Analyzer Role ARN: ARN of the role that you want assume to execute this action on AWS. Session Name: Name of the session that will be created to execute this action on AWS.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "Your account's AWS region",
                "description": "AWS region of your account to access the AWS Access Analyzer"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Log Group Names",
          "description": "The list of log groups to be queried.",
          "type": "text",
          "name": "logGroupNames",
          "required": true,
          "visible": true,
          "editable": true,
          "tooltip": "List of log groups in csv or list format. You can include up to 20 log groups.",
          "placeholder": "['MyLogGroup1', 'MyLogGroup2']"
        },
        {
          "title": "Start Time",
          "description": "The beginning of the time range to query.",
          "type": "datetime",
          "name": "startTime",
          "required": true,
          "visible": true,
          "editable": true
        },
        {
          "title": "End Time",
          "description": "The end of the time range to query.",
          "type": "datetime",
          "name": "endTime",
          "required": true,
          "visible": true,
          "editable": true
        },
        {
          "title": "Query String",
          "description": "The query string to be used.",
          "type": "text",
          "name": "queryString",
          "required": true,
          "visible": true,
          "editable": true,
          "placeholder": "fields @timestamp, @message | sort @timestamp desc"
        },
        {
          "title": "Limit",
          "description": "The maximum number of log events to be returned.",
          "type": "integer",
          "name": "limit",
          "required": false,
          "visible": true,
          "editable": true,
          "tooltip": "If left blank, the default is up to 1000 events."
        }
      ],
      "output_schema": {
        "queryId": "",
        "ResponseMetadata": {
          "RequestId": "",
          "HTTPStatusCode": "",
          "HTTPHeaders": {
            "x-amzn-requestid": "",
            "content-type": "",
            "content-length": "",
            "date": ""
          },
          "RetryAttempts": ""
        }
      }
    },
    {
      "title": "Get Log Insight Query Result",
      "operation": "get_log_insight_query_result",
      "description": "Returns the results from the specified query.",
      "category": "utilities",
      "enabled": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Enable to assume a role",
          "description": "Select this option to assume a role. This parameter is required, if you have specified 'IAM Role' as the 'Configuration Type'. If you have specified 'Access Credentials' as the 'Configuration Type', then this parameter is optional. If you choose'True', then you must specify the following parameters: AWS Region: AWS region of your account to access the AWS Access Analyzer Role ARN: ARN of the role that you want assume to execute this action on AWS. Session Name: Name of the session that will be created to execute this action on AWS.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "Your account's AWS region",
                "description": "AWS region of your account to access the AWS Access Analyzer"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Log Insight Query ID",
          "description": "The ID number of the log insight query.",
          "type": "text",
          "name": "queryId",
          "required": true,
          "visible": true,
          "editable": true,
          "tooltip": "The ID number of the log insight query."
        }
      ],
      "output_schema": {
        "results": [],
        "statistics": {
          "recordsMatched": "",
          "recordsScanned": "",
          "bytesScanned": ""
        },
        "status": "",
        "ResponseMetadata": {
          "RequestId": "",
          "HTTPStatusCode": "",
          "HTTPHeaders": {
            "x-amzn-requestid": "",
            "content-type": "",
            "content-length": "",
            "date": ""
          },
          "RetryAttempts": ""
        }
      }
    },
    {
      "title": "Stop Log Insight Query",
      "operation": "stop_log_insight_query",
      "description": "Stops a CloudWatch Logs Insights query that is in progress.",
      "category": "utilities",
      "enabled": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Enable to assume a role",
          "description": "Select this option to assume a role. This parameter is required, if you have specified 'IAM Role' as the 'Configuration Type'. If you have specified 'Access Credentials' as the 'Configuration Type', then this parameter is optional. If you choose'True', then you must specify the following parameters: AWS Region: AWS region of your account to access the AWS Access Analyzer Role ARN: ARN of the role that you want assume to execute this action on AWS. Session Name: Name of the session that will be created to execute this action on AWS.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "Your account's AWS region",
                "description": "AWS region of your account to access the AWS Access Analyzer"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Log Insight Query ID",
          "description": "The ID number of the log insight query to stop.",
          "type": "text",
          "name": "queryId",
          "required": true,
          "visible": true,
          "editable": true,
          "tooltip": "The ID number of the log insight query to stop."
        }
      ],
      "output_schema": {
        "success": "",
        "ResponseMetadata": {
          "RequestId": "",
          "HTTPStatusCode": "",
          "HTTPHeaders": {
            "x-amzn-requestid": "",
            "content-type": "",
            "content-length": "",
            "date": ""
          },
          "RetryAttempts": ""
        }
      }
    }
  ]
}
{
  "name": "aws-cloudwatch-log",
  "version": "1.0.0",
  "label": "AWS CloudWatch Log",
  "description": "AWS CloudWatch Log helps you monitor, store, and access your system, application, and custom log files. This connector facilitates the automate operations related to the log group, log streams and metrics.",
  "publisher": "Fortinet",
  "cs_approved": true,
  "cs_compatible": true,
  "category": "Monitoring",
  "icon_small_name": "cyops_small.png",
  "icon_large_name": "cyops_large.png",
  "help_online": "https://docs.fortinet.com/document/fortisoar/1.0.0/aws-cloudwatch-logs/450/aws-cloudwatch-logs-v1-0-0",
  "configuration": {
    "fields": [
      {
        "title": "Configuration Type",
        "required": true,
        "editable": true,
        "visible": true,
        "type": "select",
        "name": "config_type",
        "tooltip": "Select the Configuration Type from IAM Role or Access Credentials. The selected configuration type determines the type of credentials that you require to access AWS CloudWatch Log and perform automated actions.",
        "description": "Select the Configuration Type from IAM Role or Access Credentials. The selected configuration type determines the type of credentials that you require to access AWS CloudWatch Log and perform automated actions. Enter the requested details as per the following: \n\nIAM Role \n\nAWS Instance IAM Role: Specify the IAM Role of your AWS instance that you need to access the AWS CloudWatch Log service. \n\nAccess Credentials \n\nAWS Region: Specify the AWS region of your account required to access the AWS CloudWatch service. \n\nAWS Access Key ID: Specify the AWS Access Key's ID required to access the AWS CloudWatch service. \n\nAWS Secret Access Key: Specify the AWS Secret Access Key required to access the AWS CloudWatch Log service.",
        "options": [
          "Access Credentials",
          "AWS Instance IAM Role"
        ],
        "onchange": {
          "AWS Instance IAM Role": [
            {
              "title": "AWS Instance IAM Role Name",
              "required": true,
              "editable": true,
              "visible": true,
              "type": "text",
              "name": "aws_iam_role",
              "tooltip": "Specify the IAM Role of your AWS instance that you need to access the AWS CloudWatch Log service.",
              "description": "Specify the IAM Role of your AWS instance that you need to access the AWS CloudWatch Log service."
            }
          ],
          "Access Credentials": [
            {
              "title": "AWS Region",
              "required": true,
              "editable": true,
              "visible": true,
              "type": "text",
              "name": "aws_region",
              "placeholder": "e.g. us-east-2",
              "tooltip": "Specify the AWS region of your account required to access the AWS CloudWatch service. ",
              "description": "Specify the AWS region of your account required to access the AWS CloudWatch service. "
            },
            {
              "title": "AWS Access Key ID",
              "required": true,
              "editable": true,
              "visible": true,
              "type": "text",
              "name": "aws_access_key",
              "tooltip": "Specify the AWS Access Key's ID required to access the AWS CloudWatch service.",
              "description": "Specify the AWS Access Key's ID required to access the AWS CloudWatch service."
            },
            {
              "title": "AWS Secret Access Key",
              "required": true,
              "editable": true,
              "visible": true,
              "type": "password",
              "name": "aws_secret_access_key",
              "tooltip": "Specify the AWS Secret Access Key required to access the AWS CloudWatch Log service.",
              "description": "Specify the AWS Secret Access Key required to access the AWS CloudWatch Log service."
            }
          ]
        }
      },
      {
        "title": "Verify SSL",
        "description": "Specifies whether the SSL certificate for the server is to be verified or not. \nBy default, this option is set to True.",
        "required": false,
        "editable": true,
        "visible": true,
        "type": "checkbox",
        "name": "verify_ssl",
        "value": true
      }
    ]
  },
  "operations": [
    {
      "title": "Create Log Group",
      "operation": "create_log_group",
      "description": "Creates a log group based on the name you have specified. You can validate the log group creation at CloudWatch > Log Groups.",
      "category": "miscellaneous",
      "annotation": "create_log_group",
      "enabled": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Select this checkbox if you have specified IAM Role as the configuration type.",
          "description": "Select this checkbox if you have specified IAM Role as the configuration type in Configuration Parameters. Enabling this option makes the following parameters mandatory: \n\nAWS Region: AWS region of your account to access the AWS CloudWatch \n\nRole ARN: ARN of the role that you want assume to execute this action on AWS. \n\nSession Name: Name of the session that will be created to execute this action on AWS. \n\nIf you have specified Access Credentials as the configuration type, then enabling this parameter is optional.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "AWS region of your account to access the AWS CloudWatch",
                "description": "AWS region of your account to access the AWS CloudWatch"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Log Group Name",
          "description": "Specify a name for the log group that is being created.",
          "type": "text",
          "name": "logGroupName",
          "required": true,
          "visible": true,
          "editable": true,
          "tooltip": "Specify a name for the log group that is being created."
        },
        {
          "title": "KMS Key ARN",
          "description": "(Optional) Specify the Amazon Resource Name (ARN) of the Customer Managed Key(CMK) to use when encrypting log data.",
          "tooltip": "(Optional) Specify the Amazon Resource Name (ARN) of the Customer Managed Key(CMK) to use when encrypting log data.",
          "type": "text",
          "name": "kmsKeyId",
          "required": false,
          "visible": true,
          "editable": true,
          "placeholder": "arn:aws:kms:{{aws_region}}:{{account_id}}:key/{{key_id}}"
        },
        {
          "title": "Tags",
          "description": "(Optional) Specify the key-value pairs to add as tags.",
          "tooltip": "(Optional) Specify the key-value pairs to add as tags. e.g {\n\"CWLogs\":\"Linux\"\n}",
          "type": "json",
          "name": "tags",
          "required": false,
          "visible": true,
          "editable": true,
          "value": {
            "tagName": "tagValue"
          }
        }
      ],
      "output_schema": {
        "ResponseMetadata": {
          "RequestId": "",
          "HTTPStatusCode": "",
          "HTTPHeaders": {
            "x-amzn-requestid": "",
            "content-type": "",
            "content-length": "",
            "date": ""
          },
          "RetryAttempts": ""
        }
      }
    },
    {
      "title": "Create Log Stream",
      "operation": "create_log_stream",
      "description": "Creates a log stream based on the log group and the log stream name you have specified. You can validate the log stream creation at CloudWatch > Log Groups > Log Streams.",
      "category": "miscellaneous",
      "annotation": "create_log_stream",
      "enabled": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Select this checkbox if you have specified IAM Role as the configuration type.",
          "description": "Select this checkbox if you have specified IAM Role as the configuration type in Configuration Parameters. Enabling this option makes the following parameters mandatory: \n\nAWS Region: AWS region of your account to access the AWS CloudWatch \n\nRole ARN: ARN of the role that you want assume to execute this action on AWS. \n\nSession Name: Name of the session that will be created to execute this action on AWS. \n\nIf you have specified Access Credentials as the configuration type, then enabling this parameter is optional.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "AWS region of your account to access the AWS CloudWatch",
                "description": "AWS region of your account to access the AWS CloudWatch"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Log Group Name",
          "description": "Specify a name for the log group to which the created log stream belongs.",
          "type": "text",
          "name": "logGroupName",
          "required": true,
          "visible": true,
          "editable": true,
          "tooltip": "Specify a name for the log group to which the created log stream belongs."
        },
        {
          "title": "Log Stream Name",
          "description": "Specify a name for the log stream to be created.",
          "type": "text",
          "name": "logStreamName",
          "required": true,
          "visible": true,
          "editable": true,
          "tooltip": "Specify a name for the log stream to be created."
        }
      ],
      "output_schema": {
        "ResponseMetadata": {
          "RequestId": "",
          "HTTPStatusCode": "",
          "HTTPHeaders": {
            "x-amzn-requestid": "",
            "content-type": "",
            "content-length": "",
            "date": ""
          },
          "RetryAttempts": ""
        }
      }
    },
    {
      "title": "Get Log Groups List",
      "operation": "get_list_log_groups",
      "description": "Gets a list of the log groups based on the log group name's prefix and the number of results to display on a page. You can list all the log groups or filter the results by log group name's prefix.",
      "category": "investigation",
      "annotation": "get_list_log_groups",
      "enabled": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Select this checkbox if you have specified IAM Role as the configuration type.",
          "description": "Select this checkbox if you have specified IAM Role as the configuration type in Configuration Parameters. Enabling this option makes the following parameters mandatory: \n\nAWS Region: AWS region of your account to access the AWS CloudWatch \n\nRole ARN: ARN of the role that you want assume to execute this action on AWS. \n\nSession Name: Name of the session that will be created to execute this action on AWS. \n\nIf you have specified Access Credentials as the configuration type, then enabling this parameter is optional.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "AWS region of your account to access the AWS CloudWatch",
                "description": "AWS region of your account to access the AWS CloudWatch"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Log Group Name Prefix",
          "description": "(Optional) Specify a log group name prefix to list all the log group names starting with the specified prefix.",
          "tooltip": "(Optional) Specify a log group name prefix to list all the log group names starting with the specified prefix.",
          "type": "text",
          "name": "logGroupNamePrefix",
          "required": false,
          "visible": true,
          "editable": true
        },
        {
          "title": "Next Page Token",
          "description": "(Optional) Specify the token for the next set of items to return. If the results exceed the limit specified (default 50) then output contains the next page token as well.",
          "type": "text",
          "name": "nextToken",
          "required": false,
          "visible": true,
          "editable": true,
          "tooltip": "(Optional) Specify the token for the next set of items to return. If the results exceed the limit specified (default 50) then output contains the next page token as well."
        },
        {
          "title": "Limit",
          "description": "(Optional) Specify the maximum number of items to return. If left blank, the default is up to 50 items.",
          "tooltip": "(Optional) Specify the maximum number of items to return. If left blank, the default is up to 50 items.",
          "type": "integer",
          "name": "limit",
          "required": false,
          "visible": true,
          "editable": true,
          "value": 50
        }
      ],
      "output_schema": {
        "logGroups": [
          {
            "logGroupName": "",
            "creationTime": "",
            "metricFilterCount": "",
            "arn": "",
            "storedBytes": ""
          }
        ],
        "ResponseMetadata": {
          "RequestId": "",
          "HTTPStatusCode": "",
          "HTTPHeaders": {
            "x-amzn-requestid": "",
            "content-type": "",
            "content-length": "",
            "date": ""
          },
          "RetryAttempts": ""
        }
      }
    },
    {
      "title": "Get Log Streams List",
      "operation": "get_list_log_streams",
      "description": "Gets a list of the log streams for a specified log group based on the log group name you and the list order you have specified. You can list all the log streams or filter the results log group name's prefix.",
      "category": "investigation",
      "annotation": "get_list_log_streams",
      "enabled": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Select this checkbox if you have specified IAM Role as the configuration type.",
          "description": "Select this checkbox if you have specified IAM Role as the configuration type in Configuration Parameters. Enabling this option makes the following parameters mandatory: \n\nAWS Region: AWS region of your account to access the AWS CloudWatch \n\nRole ARN: ARN of the role that you want assume to execute this action on AWS. \n\nSession Name: Name of the session that will be created to execute this action on AWS. \n\nIf you have specified Access Credentials as the configuration type, then enabling this parameter is optional.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "AWS region of your account to access the AWS CloudWatch",
                "description": "AWS region of your account to access the AWS CloudWatch"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Log Group Name",
          "description": "Specify the name of the log group.",
          "tooltip": "Specify the name of the log group.",
          "type": "text",
          "name": "logGroupName",
          "required": true,
          "visible": true,
          "editable": true
        },
        {
          "title": "Order By",
          "name": "orderBy",
          "description": "(Optional) Select if the results are to be ordered by the Log Stream Name or Event Time \nIf you choose LogStreamName then specify a Log Stream Name prefix to match.",
          "tooltip": "(Optional) Select if the results are to be ordered by the Log Stream Name or Event Time \nIf you choose LogStreamName then specify a Log Stream Name prefix to match.",
          "visible": true,
          "required": false,
          "editable": true,
          "type": "select",
          "options": [
            "LogStreamName",
            "LastEventTime"
          ],
          "value": "LogStreamName",
          "onchange": {
            "LogStreamName": [
              {
                "title": "Log Stream Name Prefix ",
                "description": "The log stream name prefix to match.",
                "tooltip": "Prefix to match. e.g. For log stream 'MySysLogStream', provide 'MySys'. If left blank, lists all the log groups",
                "type": "text",
                "name": "logStreamNamePrefix",
                "required": false,
                "visible": true,
                "editable": true
              }
            ]
          }
        },
        {
          "title": "Next Page Token",
          "description": "(Optional) Specify the token for the next set of items to return. If the results exceed the limit specified (default 50) then output contains the next page token as well.",
          "tooltip": "(Optional) Specify the token for the next set of items to return. If the results exceed the limit specified (default 50) then output contains the next page token as well.",
          "type": "text",
          "name": "nextToken",
          "required": false,
          "visible": true,
          "editable": true
        },
        {
          "title": "Limit",
          "description": "The maximum number of items returned. If left blank, the default is up to 50 items.",
          "tooltip": "The maximum number of items returned. If left blank, the default is up to 50 items.",
          "type": "integer",
          "name": "limit",
          "required": false,
          "visible": true,
          "editable": true,
          "value": 50
        }
      ],
      "output_schema": {
        "logStreams": [
          {
            "logStreamName": "",
            "creationTime": "",
            "arn": "",
            "storedBytes": ""
          }
        ],
        "ResponseMetadata": {
          "RequestId": "",
          "HTTPStatusCode": "",
          "HTTPHeaders": {
            "x-amzn-requestid": "",
            "content-type": "",
            "content-length": "",
            "date": ""
          },
          "RetryAttempts": ""
        }
      }
    },
    {
      "title": "Get Log Events",
      "operation": "get_log_events",
      "description": "Gets all the log events, or logs for the duration and the log stream you have specified. You can view the log event entries at CloudWatch > Log Groups > Log Stream > Log Events",
      "category": "investigation",
      "annotation": "get_log_events",
      "enabled": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Select this checkbox if you have specified IAM Role as the configuration type.",
          "description": "Select this checkbox if you have specified IAM Role as the configuration type in Configuration Parameters. Enabling this option makes the following parameters mandatory: \n\nAWS Region: AWS region of your account to access the AWS CloudWatch \n\nRole ARN: ARN of the role that you want assume to execute this action on AWS. \n\nSession Name: Name of the session that will be created to execute this action on AWS. \n\nIf you have specified Access Credentials as the configuration type, then enabling this parameter is optional.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "AWS region of your account to access the AWS CloudWatch",
                "description": "AWS region of your account to access the AWS CloudWatch"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Log Group Name",
          "description": "Specify the name of the log group.",
          "tooltip": "Specify the name of the log group.",
          "type": "text",
          "name": "logGroupName",
          "required": true,
          "visible": true,
          "editable": true
        },
        {
          "title": "Log Stream Name",
          "description": "Specify the name of the log stream.",
          "tooltip": "Specify the name of the log stream.",
          "type": "text",
          "name": "logStreamName",
          "required": true,
          "visible": true,
          "editable": true
        },
        {
          "title": "Start Time",
          "description": "(Optional) Specify the start of the time range for which log events are to be fetched.",
          "tooltip": "(Optional) Specify the start of the time range for which log events are to be fetched.",
          "type": "datetime",
          "name": "startTime",
          "required": false,
          "visible": true,
          "editable": true
        },
        {
          "title": "End Time",
          "description": "(Optional) Specify the end of the time range for which log events to be fetched.",
          "tooltip": "(Optional) Specify the end of the time range for which log events to be fetched.",
          "type": "datetime",
          "name": "endTime",
          "required": false,
          "visible": true,
          "editable": true
        },
        {
          "title": "Next Page Token",
          "description": "(Optional) Specify the token for the next set of items to return. If the results exceed the limit specified (default 50) then output contains the next page token as well.",
          "tooltip": "(Optional) Specify the token for the next set of items to return. If the results exceed the limit specified (default 50) then output contains the next page token as well.",
          "type": "text",
          "name": "nextToken",
          "required": false,
          "visible": true,
          "editable": true
        },
        {
          "title": "Limit",
          "description": "(Optional) Specify the maximum number of log events that are to be listed. If not specified, the default value is 50.",
          "tooltip": "(Optional) Specify the maximum number of log events that are to be listed. If not specified, the default value is 50.",
          "type": "integer",
          "name": "limit",
          "required": false,
          "visible": true,
          "editable": true,
          "value": 10
        },
        {
          "title": "Oldest Logs First",
          "description": "(Optional) Select the checkbox if you want the earliest log events to be returned first. By default, the box is unchecked.",
          "tooltip": "(Optional) Select the checkbox if you want the earliest log events to be returned first. By default, the box is unchecked.",
          "type": "checkbox",
          "name": "startFromHead",
          "required": false,
          "visible": true,
          "editable": true,
          "value": true
        }
      ],
      "output_schema": {
        "events": [],
        "nextForwardToken": "",
        "nextBackwardToken": "",
        "ResponseMetadata": {
          "RequestId": "",
          "HTTPStatusCode": "",
          "HTTPHeaders": {
            "x-amzn-requestid": "",
            "content-type": "",
            "content-length": "",
            "date": ""
          },
          "RetryAttempts": ""
        }
      }
    },
    {
      "title": "Delete Log Group",
      "operation": "delete_log_group",
      "description": "Deletes a log group, and it's associated archived log events, permanently based on the log group name you have specified. You can validate the log group's removal from CloudWatch > Log Groups.",
      "category": "miscellaneous",
      "annotation": "delete_log_group",
      "enabled": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Select this checkbox if you have specified IAM Role as the configuration type.",
          "description": "Select this checkbox if you have specified IAM Role as the configuration type in Configuration Parameters. Enabling this option makes the following parameters mandatory: \n\nAWS Region: AWS region of your account to access the AWS CloudWatch \n\nRole ARN: ARN of the role that you want assume to execute this action on AWS. \n\nSession Name: Name of the session that will be created to execute this action on AWS. \n\nIf you have specified Access Credentials as the configuration type, then enabling this parameter is optional.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "AWS region of your account to access the AWS CloudWatch",
                "description": "AWS region of your account to access the AWS CloudWatch"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Log Group Name",
          "description": "Specify the name of the log group to be deleted.",
          "tooltip": "Specify the name of the log group to be deleted.",
          "type": "text",
          "name": "logGroupName",
          "required": true,
          "visible": true,
          "editable": true
        }
      ],
      "output_schema": {
        "ResponseMetadata": {
          "RequestId": "",
          "HTTPStatusCode": "",
          "HTTPHeaders": {
            "x-amzn-requestid": "",
            "content-type": "",
            "content-length": "",
            "date": ""
          },
          "RetryAttempts": ""
        }
      }
    },
    {
      "title": "Delete Log Stream",
      "operation": "delete_log_stream",
      "description": "Deletes the log stream and it's associated archived log events based on the log group and the log stream name you have specified. Validate log stream removal at CloudWatch > Log Groups > Log Streams.",
      "category": "miscellaneous",
      "annotation": "delete_log_stream",
      "enabled": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Select this checkbox if you have specified IAM Role as the configuration type.",
          "description": "Select this checkbox if you have specified IAM Role as the configuration type in Configuration Parameters. Enabling this option makes the following parameters mandatory: \n\nAWS Region: AWS region of your account to access the AWS CloudWatch \n\nRole ARN: ARN of the role that you want assume to execute this action on AWS. \n\nSession Name: Name of the session that will be created to execute this action on AWS. \n\nIf you have specified Access Credentials as the configuration type, then enabling this parameter is optional.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "AWS region of your account to access the AWS CloudWatch",
                "description": "AWS region of your account to access the AWS CloudWatch"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Log Group Name",
          "description": "Specify the name of the log group.",
          "tooltip": "Specify the name of the log group.",
          "type": "text",
          "name": "logGroupName",
          "required": true,
          "visible": true,
          "editable": true
        },
        {
          "title": "Log Stream Name",
          "description": "Specify the name of the log stream to be deleted.",
          "tooltip": "Specify the name of the log stream to be deleted.",
          "type": "text",
          "name": "logStreamName",
          "required": true,
          "visible": true,
          "editable": true
        }
      ],
      "output_schema": {
        "ResponseMetadata": {
          "RequestId": "",
          "HTTPStatusCode": "",
          "HTTPHeaders": {
            "x-amzn-requestid": "",
            "content-type": "",
            "content-length": "",
            "date": ""
          },
          "RetryAttempts": ""
        }
      }
    },
    {
      "title": "Update Log Retention Policy",
      "operation": "update_log_retention_policy",
      "description": "Sets a retention policy that retains log events based on the log group name and the number of days to retain.",
      "category": "miscellaneous",
      "annotation": "update_log_retention_policy",
      "enabled": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Select this checkbox if you have specified IAM Role as the configuration type.",
          "description": "Select this checkbox if you have specified IAM Role as the configuration type in Configuration Parameters. Enabling this option makes the following parameters mandatory: \n\nAWS Region: AWS region of your account to access the AWS CloudWatch \n\nRole ARN: ARN of the role that you want assume to execute this action on AWS. \n\nSession Name: Name of the session that will be created to execute this action on AWS. \n\nIf you have specified Access Credentials as the configuration type, then enabling this parameter is optional.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "AWS region of your account to access the AWS CloudWatch",
                "description": "AWS region of your account to access the AWS CloudWatch"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Log Group Name",
          "description": "Specify the name of the log group.",
          "tooltip": "Specify the name of the log group.",
          "type": "text",
          "name": "logGroupName",
          "required": true,
          "visible": true,
          "editable": true
        },
        {
          "title": "Retention Period",
          "description": "Specify the time period to retain the log events in the log group you have specified.",
          "tooltip": "Specify the time period to retain the log events in the log group you have specified.",
          "name": "retentionInDays",
          "type": "select",
          "options": [
            "1 Day",
            "3 Days",
            "5 Days",
            "1 Week",
            "2 Weeks",
            "1 Month",
            "2 Months",
            "3 Months",
            "4 Months",
            "5 Months",
            "6 Months",
            "12 Months",
            "13 Months",
            "18 Months",
            "24 Months",
            "60 Months",
            "120 Months"
          ],
          "required": true,
          "visible": true,
          "editable": true,
          "value": "1 Day"
        }
      ],
      "output_schema": {
        "ResponseMetadata": {
          "RequestId": "",
          "HTTPStatusCode": "",
          "HTTPHeaders": {
            "x-amzn-requestid": "",
            "content-type": "",
            "content-length": "",
            "date": ""
          },
          "RetryAttempts": ""
        }
      }
    },
    {
      "title": "Revert Log Retention Policy",
      "operation": "revert_log_retention_policy",
      "description": "Reverts the retention of the specified log group based on the log group name you have specified. Log events do not expire if they belong to log groups without a retention policy.",
      "category": "miscellaneous",
      "annotation": "revert_log_retention_policy",
      "enabled": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Select this checkbox if you have specified IAM Role as the configuration type.",
          "description": "Select this checkbox if you have specified IAM Role as the configuration type in Configuration Parameters. Enabling this option makes the following parameters mandatory: \n\nAWS Region: AWS region of your account to access the AWS CloudWatch \n\nRole ARN: ARN of the role that you want assume to execute this action on AWS. \n\nSession Name: Name of the session that will be created to execute this action on AWS. \n\nIf you have specified Access Credentials as the configuration type, then enabling this parameter is optional.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "AWS region of your account to access the AWS CloudWatch",
                "description": "AWS region of your account to access the AWS CloudWatch"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Log Group Name",
          "description": "Specify the log group name.",
          "tooltip": "Specify the log group name",
          "type": "text",
          "name": "logGroupName",
          "required": true,
          "visible": true,
          "editable": true
        }
      ],
      "output_schema": {
        "ResponseMetadata": {
          "RequestId": "",
          "HTTPStatusCode": "",
          "HTTPHeaders": {
            "x-amzn-requestid": "",
            "content-type": "",
            "content-length": "",
            "date": ""
          },
          "RetryAttempts": ""
        }
      }
    },
    {
      "title": "Upload Log Event",
      "operation": "upload_log_event",
      "description": "Uploads log events to the log stream based on the log's group name and the stream name specified. You can upload multiple logs by specifying a sequence ID",
      "category": "miscellaneous",
      "annotation": "upload_log_event",
      "enabled": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Select this checkbox if you have specified IAM Role as the configuration type.",
          "description": "Select this checkbox if you have specified IAM Role as the configuration type in Configuration Parameters. Enabling this option makes the following parameters mandatory: \n\nAWS Region: AWS region of your account to access the AWS CloudWatch \n\nRole ARN: ARN of the role that you want assume to execute this action on AWS. \n\nSession Name: Name of the session that will be created to execute this action on AWS. \n\nIf you have specified Access Credentials as the configuration type, then enabling this parameter is optional.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "AWS region of your account to access the AWS CloudWatch",
                "description": "AWS region of your account to access the AWS CloudWatch"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Log Group Name",
          "description": "Specify the log group name.",
          "tooltip": "Specify the log group name.",
          "type": "text",
          "name": "logGroupName",
          "required": true,
          "visible": true,
          "editable": true
        },
        {
          "title": "Log Stream Name",
          "description": "Specify the name of the log stream.",
          "tooltip": "Specify the name of the log stream.",
          "type": "text",
          "name": "logStreamName",
          "required": true,
          "visible": true,
          "editable": true
        },
        {
          "title": "Timestamp",
          "description": "Specify the timestamp of the log event.",
          "tooltip": "Specify the timestamp of the log event. Choose date or provide epoch timestamp in milliseconds\n e.g 1633890600807",
          "type": "datetime",
          "name": "timestamp",
          "required": true,
          "visible": true,
          "editable": true
        },
        {
          "title": "Message",
          "description": "Specify a message for the log event.",
          "tooltip": "Specify a message for the log event.",
          "type": "text",
          "name": "message",
          "required": true,
          "visible": true,
          "editable": true
        },
        {
          "title": "Sequence Token",
          "description": "(Optional) Specify the sequence token obtained from the response of the previous upload call.",
          "type": "text",
          "name": "sequenceToken",
          "required": false,
          "visible": true,
          "editable": true,
          "tooltip": "(Optional) Specify the sequence token obtained from the response of the previous upload call."
        }
      ],
      "output_schema": {
        "rejectedLogEventsInfo": {
          "tooOldLogEventEndIndex": ""
        },
        "ResponseMetadata": {
          "RequestId": "",
          "HTTPStatusCode": "",
          "HTTPHeaders": {
            "x-amzn-requestid": "",
            "content-type": "",
            "content-length": "",
            "date": ""
          },
          "RetryAttempts": ""
        }
      }
    },
    {
      "title": "Run Log Insight Query",
      "operation": "run_log_insight_query",
      "description": "Runs a query to get log insights using CloudWatch Logs Insights based on the comma-separated log group names, time range, and the query you have specified.",
      "category": "investigation",
      "annotation": "run_log_insight_query",
      "enabled": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Select this checkbox if you have specified IAM Role as the configuration type.",
          "description": "Select this checkbox if you have specified IAM Role as the configuration type in Configuration Parameters. Enabling this option makes the following parameters mandatory: \n\nAWS Region: AWS region of your account to access the AWS CloudWatch \n\nRole ARN: ARN of the role that you want assume to execute this action on AWS. \n\nSession Name: Name of the session that will be created to execute this action on AWS. \n\nIf you have specified Access Credentials as the configuration type, then enabling this parameter is optional.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "AWS region of your account to access the AWS CloudWatch",
                "description": "AWS region of your account to access the AWS CloudWatch"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Log Group Names",
          "description": "Specify the list of log groups, as comma-separated values, to be queried.",
          "type": "text",
          "name": "logGroupNames",
          "required": true,
          "visible": true,
          "editable": true,
          "tooltip": "Specify the list of log groups, as comma-separated values, to be queried. You can include up to 20 log groups.",
          "placeholder": "['MyLogGroup1', 'MyLogGroup2']"
        },
        {
          "title": "Start Time",
          "description": "Specify the beginning of the time range to query.",
          "tooltip": "Specify the beginning of the time range to query.",
          "type": "datetime",
          "name": "startTime",
          "required": true,
          "visible": true,
          "editable": true
        },
        {
          "title": "End Time",
          "description": "Specify the end of the time range to query.",
          "tooltip": "Specify the end of the time range to query.",
          "type": "datetime",
          "name": "endTime",
          "required": true,
          "visible": true,
          "editable": true
        },
        {
          "title": "Query String",
          "description": "Specify the query string to be used as a log insight query.",
          "tooltip": "Specify the query string to be used as a log insight query.",
          "type": "text",
          "name": "queryString",
          "required": true,
          "visible": true,
          "editable": true,
          "placeholder": "fields @timestamp, @message | sort @timestamp desc"
        },
        {
          "title": "Limit",
          "description": "Specify the maximum number of log events to be returned.",
          "type": "integer",
          "name": "limit",
          "required": false,
          "visible": true,
          "editable": true,
          "tooltip": "Specify the maximum number of log events to be returned. The default value is 1000."
        }
      ],
      "output_schema": {
        "queryId": "",
        "ResponseMetadata": {
          "RequestId": "",
          "HTTPStatusCode": "",
          "HTTPHeaders": {
            "x-amzn-requestid": "",
            "content-type": "",
            "content-length": "",
            "date": ""
          },
          "RetryAttempts": ""
        }
      }
    },
    {
      "title": "Get Log Insight Query Result",
      "operation": "get_log_insight_query_result",
      "description": "Gets results of a log insight query based on the query ID that you have specified.",
      "category": "investigation",
      "annotation": "get_log_insight_query_result",
      "enabled": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Select this checkbox if you have specified IAM Role as the configuration type.",
          "description": "Select this checkbox if you have specified IAM Role as the configuration type in Configuration Parameters. Enabling this option makes the following parameters mandatory: \n\nAWS Region: AWS region of your account to access the AWS CloudWatch \n\nRole ARN: ARN of the role that you want assume to execute this action on AWS. \n\nSession Name: Name of the session that will be created to execute this action on AWS. \n\nIf you have specified Access Credentials as the configuration type, then enabling this parameter is optional.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "AWS region of your account to access the AWS CloudWatch",
                "description": "AWS region of your account to access the AWS CloudWatch"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Log Insight Query ID",
          "description": "Specify the ID of the log insight query.",
          "type": "text",
          "name": "queryId",
          "required": true,
          "visible": true,
          "editable": true,
          "tooltip": "Specify the ID of the log insight query."
        }
      ],
      "output_schema": {
        "results": [],
        "statistics": {
          "recordsMatched": "",
          "recordsScanned": "",
          "bytesScanned": ""
        },
        "status": "",
        "ResponseMetadata": {
          "RequestId": "",
          "HTTPStatusCode": "",
          "HTTPHeaders": {
            "x-amzn-requestid": "",
            "content-type": "",
            "content-length": "",
            "date": ""
          },
          "RetryAttempts": ""
        }
      }
    },
    {
      "title": "Stop Log Insight Query",
      "operation": "stop_log_insight_query",
      "description": "Stops a CloudWatch Logs Insights query that is in progress based on the query ID you have specified.",
      "category": "miscellaneous",
      "annotation": "stop_log_insight_query",
      "enabled": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Select this checkbox if you have specified IAM Role as the configuration type.",
          "description": "Select this checkbox if you have specified IAM Role as the configuration type in Configuration Parameters. Enabling this option makes the following parameters mandatory: \n\nAWS Region: AWS region of your account to access the AWS CloudWatch \n\nRole ARN: ARN of the role that you want assume to execute this action on AWS. \n\nSession Name: Name of the session that will be created to execute this action on AWS. \n\nIf you have specified Access Credentials as the configuration type, then enabling this parameter is optional.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "AWS region of your account to access the AWS CloudWatch",
                "description": "AWS region of your account to access the AWS CloudWatch"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Log Insight Query ID",
          "description": "Specify the ID of the log insight query to stop.",
          "type": "text",
          "name": "queryId",
          "required": true,
          "visible": true,
          "editable": true,
          "tooltip": "Specify the ID of the log insight query to stop."
        }
      ],
      "output_schema": {
        "success": "",
        "ResponseMetadata": {
          "RequestId": "",
          "HTTPStatusCode": "",
          "HTTPHeaders": {
            "x-amzn-requestid": "",
            "content-type": "",
            "content-length": "",
            "date": ""
          },
          "RetryAttempts": ""
        }
      }
    }
  ]
}
